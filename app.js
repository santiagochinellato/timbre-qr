!function(a){define(function(require,b,c){var d=require("jsCore/rpc"),e=require("common/common"),f=require("jsCore/ability"),g=c.exports=function(){var b=this;b.CLOUDWEB=!1,b.CHANNEL_NUMBER=1,b.CHANNEL_TYPE=[],b.AUDIO_IN_NUMBER=0,b.AUDIO_OUT_NUMBER=0,b.ALARM_IN_NUMBER=0,b.ALARM_OUT_NUMBER=0,b.ALARM_PIR=!1,b.ALARM_FLASH=!1,b.VideoStandard="PAL",b.MaxExtraStream=1,b.IsLocalStore=!1,b.Is3G=!1,b.IsIPCIntel=!1,b.IsSDIntel=!1,b.Is4G=!1,b.Is5G=!1,b.WIFI=!1,b.HasPtz=!1,b.DeviceType=webCaps.deviceClass?webCaps.deviceClass+webCaps.deviceType.replace(/IPC|SD|TPC/g,webCaps.deviceClass):webCaps.deviceType,b.Vendor=webCaps.vendor,b.DeviceSubClass=webCaps.DeviceSubClass,b.VSPs=[],b.EncryptInfo=null,b.DisplayMode=-1===b.DeviceType.indexOf("TPC")&&localStorage.getItem("DHVideoWHMode")||"Original Rate",b.IsNewProtocol=!1,b.NotifyVersion="1.0",b.listMethod=["system.multiSec"],b.GongAnDetect=!1,b.isSupportCrowd=!1,b.PresetID=0,b.EventCaps={},b.MaxBitRate=[0,0,0],b.DefaultEvent={FlashEnable:!1,FlashLatch:!1,RecordEnable:!1,RecordLatch:!1,MailEnable:!1,SnapshotEnable:!1,PtzLinkEnable:!1,AlarmOutEnable:!1,AlarmOutLatch:!1,VoiceEnable:!1,MMSEnable:!1,ShowQuickFocus:!1},b.resolution={x:1920,y:1080,rate:1.3333},b.CamType=-1,b.isFixFocusDoubleThermal=!1,require.async("js/index.js?version="+(new Date).getTime(),function(c){b.loginPage=new c({element:a("#login").translation()})}),b.playMode="ocx",b.newAuthority=!0,b.hide_by_dialog=!1,b.isSpecialPtz=!1,b.panoramaDrag=!1,b.isIpdDevice=-1===b.DeviceType.indexOf("TPC")&&-1!==b.DeviceType.indexOf("SD"),b.TrackObjectRegionFocus=!1,b.RegionFocusTrackObject=!1,b.TrackObjectLocate=!1,b.LocateTrackObject=!1,b.RegionFocusLocate=!1,b.LocateRegionFocus=!1,b.mTokenPsw="",b.supportSafetyAbnormalAlarm=!1,b.SmartEncodeChangeNeedReboot=!0,b.pswMask="********************",b.defaultPsw=["******","*****"],b.supportPswMask=!0,b.DefPswMaskCfg=[{value:"******",caps:!0},{value:"*****",caps:!0}],b.isNewDHOPVersion=!1,b.IsGlobalCam=!1,b.CaliSceneSplit={},b.PTZCaps=[],b.rayRightState=!1,b.isPrivateProtocol=!1,b.NoStorage=!1,b.OSInfo={},b.IPCSupportPTZ=!1,b.CloudAccessInfo=function(){var a={title:"",titleForSet:"",appUrl:""},c=b.Vendor===Base64.decode("RGFodWE=")||"FS"===b.Vendor;return webCaps.SupportDeviceInitSimplify&&webCaps.SupportGetOneDevOneSecState?(a.titleForSet="sys.CloudAccess","SimpChinese"===global.currentLanguage?c?(a.title="com.PrivateCloud",a.titleForSet="com.PrivateCloud",a.appUrl="https://www.cloud-dahua.com/h5/#/download/12"):a.title="sys.CloudAccess":(c?(a.title="Dolynk Cloud",a.titleForSet="Dolynk Cloud"):(a.title="sys.CloudAccess2",a.titleForSet="sys.CloudAccess2"),a.appUrl="http://webview.dolynkcloud.com/download/mobile/dmss.html")):(a.title="sys.CloudAccess",1===webCaps.is_show_CloudAccess?a.appUrl="http://a.app.qq.com/o/simple.jsp?pkgname=com.mm.android.lc":2===webCaps.is_show_CloudAccess?(a.appUrl="http://mobile.easy4ipcloud.com/easy4ip/detect.html",webCaps.isNewPaas&&(a.appUrl=c?"http://www.dahuatech.com/download/detect.html":"Lechange"===webCaps.vendor?"http://mobile.easy4ipcloud.com/imou/detect.html":"http://mobile.easy4ipcloud.com/EasyViewer/EasyViewer.html")):3===webCaps.is_show_CloudAccess&&(a.appUrl="http://www.dahuatech.com/download/detect.html"),(webCaps.is_show_YunLian||webCaps.is_show_YunRui)&&(a.appUrl="")),a}()};g.prototype.$=a,g.prototype.getGlobalConfigs=function(){var b=this;webCaps.NoSF&&a.ajax({url:"/web_caps/webCapsConfig?version=2.400&"+(new Date).getTime(),dataType:"json",async:!1}).done(function(b){webCaps=a.extend(!0,webCaps,b)}),b.CLOUDWEB||d.MagicBox.getSystemInfoNew().done(function(b){if(b&&b.SyncTime&&"PerLogin"===b.SyncTime.Strategy){var c=new Date,e=c.getFullYear()+"-"+a.pad(c.getMonth()+1,2)+"-"+a.pad(c.getDate(),2),f=a.pad(c.getHours(),2)+":"+a.pad(c.getMinutes(),2)+":"+a.pad(c.getSeconds(),2);d.Global.setCurrentTime(e+" "+f,5)}});var c=a.Deferred();return a.when.apply(null,[f.multiInstanceGet(),f.multiGet()]).done(function(){var e=[];e.push(f.get("ChannelNum")),e.push(f.get("AlarmIn")),e.push(f.get("AlarmOut")),e.push(f.is("AlarmPir")),e.push(f.get("VideoStandard")),e.push(f.get("OSInfo")),e.push(f.get("AudioInputNum")),e.push(f.get("AudioOutputNum")),e.push(f.is("3G")),e.push(f.is("4G")),e.push(f.get("EncryptInfo")),e.push(f.is("Flash")),e.push(f.get("getPreset")),e.push(f.get("EventCaps")),e.push(f.get("PTZCaps")),e.push(f.is("5G")),e.push(f.get("BlueToothDeviceManager")),e.push(f.get("DHOPVersion")),e.push(f.get("PD")),e.push(f.is("DSPConflict")),e.push(f.get("DebugInfoCaps")),e.push(f.get("VideoChannelsInfo")),a.when.apply(null,e).done(function(){var e=arguments;b.PD=e[18],b.CHANNEL_NUMBER=b.CLOUDWEB?1:e[0],b.ALARM_IN_NUMBER=e[1],b.ALARM_OUT_NUMBER=e[2],b.ALARM_PIR=e[3],b.MaxExtraStream=b.PD.MaxExtraStream,b.IsLocalStore=b.PD.IsLocalStore||!1,b.VideoStandard=e[4]||"PAL",b.OSInfo=e[5],b.HasPtz=b.PD.HasPtz||!1,b.AUDIO_IN_NUMBER=e[6],b.AUDIO_OUT_NUMBER=e[7],b.IsNewProtocol="V3"===b.PD.CameraSwitchComV||-1!==b.DeviceType.indexOf("TPC")?!0:!1,b.Is3G=!!e[8],b.Is4G=!!e[9],b.Is5G=!!e[15],b.EncryptInfo=e[10];try{Object.defineProperty(b,"EncryptInfo",{writable:!1}),Object.defineProperty(b.EncryptInfo,"asymmetric",{writable:!1})}catch(f){}if(a.isArray(b.PD.VSPs)?b.VSPs=b.PD.VSPs:b.PD.VSP&&"none"!==b.PD.VSP.toLowerCase()&&(b.VSPs=[b.PD.VSP]),b.ALARM_FLASH=e[11],b.IsIPCIntel=-1!==b.DeviceType.indexOf("IPC")&&b.PD.VideoAnalyse&&b.PD.VideoAnalyse.Support,b.IsSDIntel=-1!==b.DeviceType.indexOf("SD")&&b.PD.VideoAnalyse&&b.PD.VideoAnalyse.Support,webCaps.is_show_newIntelli){var g=["TrafficPark","IntelliCityMgr","TrafficIllegal","Traffic","ElecPolice"],h=b.PD.VideoAnalyse&&b.PD.VideoAnalyse.SupportedScene&&b.PD.VideoAnalyse.SupportedScene.some(function(a){return-1!==g.indexOf(a)});b.IsSDTraficIntel=b.IsSDIntel&&h,b.SDTraficIntelType=b.PD.VideoAnalyse.SupportedScene}else b.IsSDTraficIntel=b.IsSDIntel&&b.PD.VideoAnalyse.SupportScenes&&-1!==b.PD.VideoAnalyse.SupportScenes.indexOf("Traffic");if(b.GongAnDetect="GongAnDetect"===b.PD.SpecVer?!0:!1,b.PresetID=e[12],b.EventCaps=e[13],b.PD.HLSCaps&&(b.MaxBitRate=b.PD.HLSCaps[0].MaxBitRate),b.CloudUpgrade=b.PD.SupportCloudUpgrade,b.NoIntelliPreset=!(!e[14]||!e[14].IntelliPtzPreset||e[14].IntelliPtzPreset.Support!==!1),b.PtzFunctionMenu=b.PD.PtzFunctionMenu&&b.PD.PtzFunctionMenu.Support,0===b.CHANNEL_TYPE.length)for(var i=0;i<b.CHANNEL_NUMBER;i++)b.CHANNEL_TYPE.push("visible");b.supportSafetyAbnormalAlarm=!!b.PD.SupportSafetyAbnormalAlarm,b.SmartEncodeChangeNeedReboot=b.PD.SmartEncodeChangeNeedReboot!==!1,b.Bluetooth=e[16]&&e[16].Support,b.isNewDHOPVersion=e[17],b.IsGlobalCam=!b.PD.MasterSlaveGroup||"GlobalCamera"!==b.PD.MasterSlaveGroup.role&&"GlobalCamera2"!==b.PD.MasterSlaveGroup.role&&"IllegalCamera"!==b.PD.MasterSlaveGroup.role?!1:!0,b.CaliSceneSplit=b.PD.MasterSlaveGroup&&b.PD.MasterSlaveGroup.CaliSceneSplit,b.isPrivateProtocol=b.PD.SupportPrivateSignaling,b.isConflict=e[19],b.PTZCaps[0]=e[14],b.SupportSysLogExport=e[20]&&e[20].DebugLogExport&&e[20].DebugLogExport.SupportSysLogExport,b.IPCSupportPTZ=-1!==b.DeviceType.indexOf("IPC")&&!!(e[21]&&e[21].Input&&e[21].Input.SD&&e[21].Input.SD.length),b.NoStorage=!b.IsLocalStore&&webCaps.isHideFTP&&!isEnable("show_NAS_config"),b.checkVariableItem=function(){var c=["Normal","FaceDetection","FaceAnalysis","NumberStat","ObjectDetect","ForeignDetection","OperateMonitor","ElevatorAccessControl","ObjectMonitor","WaterMonitor","BoatDetection","SmokeDetection"],e={Intelligent:{SmartMotion:["ivs.SmartConflictTip","ivs.SmartRebootTip"],HighFPS:["ivs.HighFPSConflictTip","ivs.HighFPSConflictTip"],FlexStream:["ivs.FSSmartflictTip","ivs.FSSmartflictTip"]},SmartMotion:{Intelligent:["ivs.SmartConflictTip","ivs.SmartRebootTip"],HighFPS:["ivs.HighFPSConflictTip","ivs.HighFPSConflictTip"],FlexStream:["ivs.FSSmartflictTip","ivs.FSSmartflictTip"]},HighFPS:{Intelligent:["ivs.HighFPSConflictTip","ivs.HighFPSConflictTip"],SmartMotion:["ivs.HighFPSConflictTip","ivs.HighFPSConflictTip"]},FlexStream:{Intelligent:["ivs.FSSmartflictTip","ivs.FSSmartflictTip"],SmartMotion:["ivs.FSSmartflictTip","ivs.FSSmartflictTip"]}},f=[];return b.PD.ConflictFuncList&&a.each(b.PD.ConflictFuncList,function(b,c){var d=[];c.FuncType&&a.each(c.FuncType,function(b,c){a.merge(d,c.Item)}),f.push(d)}),function(b,g,h,i){var j=a.Deferred();if(h=h||0,!f[h]||-1===f[h].indexOf(b)&&"Intelligent"!==b)j.resolve(!0);else{var k="",l=0;d.DevVariableCapsManager.checkStart(b,g,h,i).done(function(f){if(f&&f.FunTypes){var g=a.Deferred(),h=f.FunTypes[0].ExclusionType;k=h[0]===b||"Intelligent"===b&&-1!==c.indexOf(h[0])?h[1]:h[0],-1!==c.indexOf(k)&&(k="Intelligent"),f.Reboot&&(l=1);var i="";if("HighFPS"===b||"HighFPS"===k){var m=25;d.ConfigManager.getConfig("VideoStandard").done(function(a){"NTSC"===a&&(m=30)}).always(function(){i=tl(e[b][k][l],m),g.resolve(!0)})}else i=tl(e[b][k][l]),g.resolve(!0);a.when(g).done(function(){a.confirm("",i,function(){j.resolve(!0)},function(){j.resolve(!1)},!0)})}else j.resolve(!0)}).fail(function(){j.resolve(!0)})}return j}}(),c.resolve()})}),c},g.prototype.isNeedReboot=function(b){if(a.isArray(b)){if(-1!==a.inArray("NeedReboot",b)||-1!==a.inArray("NeedRestart",b))return!0;for(var c=b.length-1;c>=0;c--)if(b[c]&&b[c].params&&a.isArray(b[c].params.options)&&(-1!==a.inArray("NeedRestart",b[c].params.options)||-1!==a.inArray("NeedReboot",b[c].params.options)))return!0}return!1},g.prototype.reboot=function(b,c){function e(){d.MagicBox.reboot(),setTimeout(function(){plugin.Reload()},11e3)}g.CLOUDWEB&&!c&&(b="com.TripartiteRedirectPrompt"),a.dialog({title:tl("com.NeedRebootDeviceTip"),content:'<i class="i-dialog-warn"></i><span class="u-dialog-context">'+tl(b)+"</span>",closeable:c?!0:!1,buttons:c?[{name:"Yes",callback:function(){this.close(),e()}},{name:"No",callback:function(){this.close()}}]:[],iconIndex:1,zIndex:"h5"===this.playMode?10003:10001}),c||e()},g.prototype.isWeakPassword=function(a,b){if(webCaps.IsSupportWeak||webCaps.is_weak_Pwd){var c="",d="",e="";return b?(c=b.split("").reverse().join(""),d=new RegExp(b+"|"+c),a.match(d)||a.match(/(.)\1{6}/)?e="sys.UserPasswordInvalidChar2":-1!==WeakPwdLib.indexOf(a)&&(e="com.PasswordEasyToGuess"),e):!1}};var h={IsShowUshield:"is_show_Ushield",IsShowLegalInfo:"is_show_LegalInfo",IsShowPersonalInfoProtection:"is_show_PersonalInfoProtection",IsShowCloudAccess:"is_show_CloudAccess",IsShowYunLian:"is_show_YunLian",IsNewPaas:"isNewPaas",vendor:"vendor",cloudAccessEnable:"cloudAccessEnable",IsHideCloudUpgrade:"isHideCloudUpgrade",IsShowInitPN:"is_show_InitPN",DefaultPNSupport:"DefaultPNSupport",Nation2Language:"Nation2Language",MultiLanguage:"MultiLanguage",IsShowPswResetNew:"is_show_PswResetNew",SN:"SN",Anonymous:"Anonymous",IsShowDevInit:"is_show_DevInit",IsShowInitPagesAdjust:"is_show_InitPages_adjust",IsShowResetPsw:"is_show_ResetPsw",IsShowResetPswNewTip:"is_showResetPswNewTip",DeviceSubClass:"DeviceSubClass",deviceType:"deviceType",IsShowLDAP:"is_show_LDAP",IsShowYunRui:"is_show_YunRui"};!function(){d.DevInit.getStatus("/RPC2",!1).done(function(){d.setOutsideRPC&&d.setOutsideRPC(!0)})}(),function(){d.WebInit.getCaps().done(function(a){if(webCaps=a,a)for(var b in a)webCaps[h[b]||b]=a[b]}).fail(function(){a.ajax({url:"/web_caps/webCapsConfig?version=2.400&"+(new Date).getTime(),dataType:"json",async:!1}).done(function(a){webCaps=a}).fail(function(){webCaps={Anonymous:!1,deviceType:"IPC",mode:"IPC",vendor:" "}})}).always(function(){var b={};webCaps.Nation2Language&&webCaps.Nation2Language.Turkey&&(a.each(webCaps.Nation2Language,function(a,c){var d=a;"turkey"===d.toLowerCase()&&(d="TÃ¼rkiye"),b[d]=c}),webCaps.Nation2Language=b),(webCaps.IsSupportWeak||webCaps.is_weak_Pwd)&&a.ajax({url:"/WeakPwdLib.txt",dataType:"text",async:!1}).done(function(a){WeakPwdLib=a.split("\r\n")})})}(),window.plugin=require("jsCore/plugin"),window.rpc=d,window.ability=f,window.common=e})}(jQuery);